{% extends 'base_vehicle.html' %} 
{% block externalcss %}
<link rel="stylesheet" href="/static/css/dataTables.bootstrap.css" type="text/css"/>
{% endblock %}
{% block pagecontent %}

<div class="btn-add-edit-delete">
  <a id="expense-add" class="btn btn-primary btn-add-edit-delete" href="/vehicle/{{ car.key.id }}/expenses/add"><i class="icon-plus"></i> Add Expense</a>
  <a id="expense-edit" class="btn btn-inverse btn-add-edit-delete" disabled="disabled" onClick="editRecord('/vehicle/{{ car.key.id }}/expense/edit/')"><i class="icon-edit"></i> Edit Record</a>
  <a id="expense-delete" class="btn btn-danger btn-add-edit-delete" disabled="disabled" onClick="editRecord('/vehicle/{{ car.key.id }}/expense/delete/')"><i class="icon-remove"></i> Delete Record</a>
</div>

<h2 class="expense-header">Expense Manager</h2>

{% if not userexpenses %}
<br>
<div class="expense-subheader-1">
  <p>You don't have any expenses recorded yet.</p>
  <p>Record one <a href="/vehicle/{{ car.key.id }}/expenses/add">here</a>!</p>
</div>
{% else %}
<h3 class="expense-subheader-1">Total Money Spent: ${{ expensetotal }}</h3>

<div id="alert-area"></div>

<table class="table table-striped table-bordered dataTable DTTT_selectable table-hover" id="expense-table">
  <thead>
    <tr>
      <th>Date</th>
      <th>Category</th>
      <th>Location</th>
      <th>Description</th>
      <th>Cost</th>
      <th>Picture</th>
    </tr>
  </thead>
  <tbody>
  {% for e in userexpenses %}
  <tr id="{{ e.key.id }}">
    <td>{{ e.date_formatted }}</td>
    <td>{{ e.category }}</td>
    <td>{{ e.location }}</td>
    <td>{{ e.description }}</td>
    <td>{{ e.amount_formatted }}</td>
    
    {% if e.picture %}
    <td><button type="button" class="btn btn-success receiptlink" value="/blob/{{ e.picture }}">Receipt</a></td>
    {% else %}
    <td>N/A</td>
    {% endif %}
  </tr>
  {% endfor %}
  </tbody>
</table>

<div id="displayimage" class="modal hide fade img-modal">
  <img id="modalimage" width="400">
</div>

{% endif %} {% endblock %} {% block externaljs %}
<script type="text/javascript" src="/static/js/ext/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/static/js/ext/dataTables.bootstrap.js"></script>
<script type="text/javascript" src="/static/js/ext/TableTools.js"></script>
<script type="text/javascript" src="/static/js/expenses.js"></script>
{% endblock %}
